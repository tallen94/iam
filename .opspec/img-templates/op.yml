name: templates
description: runs all the template generation

inputs:
  appDir:
    dir:
      default: .

  version:
    string:
      description: version to use for iam
      
run:
  container:
    image:
      ref: ubuntu:18.04
    dirs:
      /src: $(appDir)
    envVars:
      TAG: "icanplayguitar94/iam:base-$(version)"
    workDir: /src
    cmd: 
    - bash
    - -c
    - | 

      # Image Templates
      bash images/templates/client.sh $TAG
      bash images/templates/builder.sh $TAG
      bash images/templates/job.sh $TAG
      bash images/templates/secret.sh $TAG
