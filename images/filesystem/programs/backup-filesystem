import json
import requests
import boto3
import os

args = json.loads(input())
folders = requests.get("http://" + args["filesystem"] + "/files").json()

for folder in folders:
    for file in folder["files"]:
        tmp = open(file["name"], "w")
        tmp.write(file["data"])
        tmp.close()
        
        s3client = boto3.client('s3')
        response = s3client.upload_file(file["name"], args["bucket"], file["name"])
        
        os.remove(file["name"])